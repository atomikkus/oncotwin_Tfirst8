version: '3.8'

services:
  # The OncoTwin API service
  api:
    build:
      context: .
      dockerfile: Dockerfile   
    container_name: oncotwin_api_2
    ports:
      - "8002:8002"
    volumes:
      # Mount the api_outputs directory to persist results on the host machine
      - ./api_outputs:/app/api_outputs
      # Mount the .env file so python-dotenv can read it
      - ./.env:/app/.env:ro
    environment:
      # Pass credentials from a local .env file into the container
      # These are also available via the mounted .env file, but explicit env vars take precedence
      - API_KEY=${API_KEY}
      - USER_EMAIL=${USER_EMAIL}
      - USER_PASSWORD=${USER_PASSWORD}
      - ECRF_EMAIL=${ECRF_EMAIL}
      - ECRF_PASSWORD=${ECRF_PASSWORD}
    restart: unless-stopped 